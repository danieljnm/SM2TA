package danieljnm.sm2ta;

import danieljnm.sm2ta.StateMachine.State;
import danieljnm.sm2ta.StateMachine.StateMachine;
import org.eclipse.xtend2.lib.StringConcatenation;
import org.eclipse.xtext.xbase.lib.InputOutput;
import org.eclipse.xtext.xbase.lib.Procedures.Procedure1;
import org.junit.jupiter.api.Assertions;
import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.Test;

@SuppressWarnings("all")
public class XmlTranslationTest {
  private StateMachine stateMachine;

  @BeforeEach
  public void reset() {
    StateMachine _stateMachine = new StateMachine();
    this.stateMachine = _stateMachine;
  }

  @Test
  public void emptyMachine() {
    this.stateMachine.name("test");
    StringConcatenation _builder = new StringConcatenation();
    _builder.append("<?xml version=\"1.0\" encoding=\"utf-8\"?>");
    _builder.newLine();
    _builder.append("<nta>");
    _builder.newLine();
    _builder.append("<declaration>");
    _builder.newLine();
    _builder.append("</declaration>");
    _builder.newLine();
    _builder.append("<template>");
    _builder.newLine();
    _builder.append("\t");
    _builder.append("<name>test</name>");
    _builder.newLine();
    _builder.append("</template>");
    _builder.newLine();
    _builder.append("<system>");
    _builder.newLine();
    _builder.append("\t");
    _builder.append("test");
    _builder.newLine();
    _builder.append("</system>");
    _builder.newLine();
    _builder.append("</nta>");
    _builder.newLine();
    final String xml = _builder.toString();
    Assertions.assertEquals(xml, this.stateMachine.toXml());
  }

  @Test
  public void states() {
    this.stateMachine.name("test").state("one").initial().state("two");
    StringConcatenation _builder = new StringConcatenation();
    _builder.append("<?xml version=\"1.0\" encoding=\"utf-8\"?>");
    _builder.newLine();
    _builder.append("<nta>");
    _builder.newLine();
    _builder.append("<declaration>");
    _builder.newLine();
    _builder.append("</declaration>");
    _builder.newLine();
    _builder.append("<template>");
    _builder.newLine();
    _builder.append("\t");
    _builder.append("<name>test</name>");
    _builder.newLine();
    _builder.append("\t");
    _builder.append("<location id=\"one\" x=\"0\" y=\"0\">");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("<name x=\"-15\" y=\"15\">one</name>");
    _builder.newLine();
    _builder.append("\t");
    _builder.append("</location>");
    _builder.newLine();
    _builder.append("\t");
    _builder.append("<location id=\"two\" x=\"400\" y=\"0\">");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("<name x=\"385\" y=\"15\">two</name>");
    _builder.newLine();
    _builder.append("\t");
    _builder.append("</location>");
    _builder.newLine();
    _builder.append("\t");
    _builder.append("<init ref=\"one\"/>");
    _builder.newLine();
    _builder.append("</template>");
    _builder.newLine();
    _builder.append("<system>");
    _builder.newLine();
    _builder.append("\t");
    _builder.append("test");
    _builder.newLine();
    _builder.append("</system>");
    _builder.newLine();
    _builder.append("</nta>");
    _builder.newLine();
    final String xml = _builder.toString();
    Assertions.assertEquals(xml, this.stateMachine.toXml());
  }

  @Test
  public void transitions() {
    this.stateMachine.name("test").state("one").initial().transition("two").guard("false").when("test").transition("two").guard("true").when("test").state("two").transition("three").timeout(5).signal("finish");
    StringConcatenation _builder = new StringConcatenation();
    _builder.append("<?xml version=\"1.0\" encoding=\"utf-8\"?>");
    _builder.newLine();
    _builder.append("<nta>");
    _builder.newLine();
    _builder.append("\t");
    _builder.append("<declaration>");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("clock gen_clock;");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("chan test, finish;");
    _builder.newLine();
    _builder.append("\t");
    _builder.append("</declaration>");
    _builder.newLine();
    _builder.append("\t");
    _builder.append("<template>");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("<name>test</name>");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("<location id=\"one\" x=\"0\" y=\"0\">");
    _builder.newLine();
    _builder.append("\t\t\t");
    _builder.append("<name x=\"-15\" y=\"15\">one</name>");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("</location>");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("<location id=\"two\" x=\"400\" y=\"0\">");
    _builder.newLine();
    _builder.append("\t\t\t");
    _builder.append("<name x=\"385\" y=\"15\">two</name>");
    _builder.newLine();
    _builder.append("\t\t\t");
    _builder.append("<label kind=\"invariant\" x=\"385\" y=\"30\">gen_clock &lt;= 5</label>");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("</location>");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("<location id=\"three\" x=\"800\" y=\"0\">");
    _builder.newLine();
    _builder.append("\t\t\t");
    _builder.append("<name x=\"785\" y=\"15\">three</name>");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("</location>");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("<init ref=\"one\"/>");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("<transition>");
    _builder.newLine();
    _builder.append("\t\t\t");
    _builder.append("<source ref=\"one\"/>");
    _builder.newLine();
    _builder.append("\t\t\t");
    _builder.append("<target ref=\"two\"/>");
    _builder.newLine();
    _builder.append("\t\t\t");
    _builder.append("<label kind=\"guard\" x=\"150\" y=\"15\">0</label>");
    _builder.newLine();
    _builder.append("\t\t\t");
    _builder.append("<label kind=\"synchronisation\" x=\"150\" y=\"30\">test?</label>");
    _builder.newLine();
    _builder.append("\t\t\t");
    _builder.append("<label kind=\"assignment\" x=\"150\" y=\"45\">gen_clock := 0</label>");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("</transition>");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("<transition>");
    _builder.newLine();
    _builder.append("\t\t\t");
    _builder.append("<source ref=\"one\"/>");
    _builder.newLine();
    _builder.append("\t\t\t");
    _builder.append("<target ref=\"two\"/>");
    _builder.newLine();
    _builder.append("\t\t\t");
    _builder.append("<label kind=\"guard\" x=\"150\" y=\"60\">1</label>");
    _builder.newLine();
    _builder.append("\t\t\t");
    _builder.append("<label kind=\"synchronisation\" x=\"150\" y=\"75\">test?</label>");
    _builder.newLine();
    _builder.append("\t\t\t");
    _builder.append("<label kind=\"assignment\" x=\"150\" y=\"90\">gen_clock := 0</label>");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("</transition>");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("<transition>");
    _builder.newLine();
    _builder.append("\t\t\t");
    _builder.append("<source ref=\"two\"/>");
    _builder.newLine();
    _builder.append("\t\t\t");
    _builder.append("<target ref=\"three\"/>");
    _builder.newLine();
    _builder.append("\t\t\t");
    _builder.append("<label kind=\"guard\" x=\"550\" y=\"15\">gen_clock &gt;= 5</label>");
    _builder.newLine();
    _builder.append("\t\t\t");
    _builder.append("<label kind=\"synchronisation\" x=\"550\" y=\"30\">finish!</label>");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("</transition>");
    _builder.newLine();
    _builder.append("\t");
    _builder.append("</template>");
    _builder.newLine();
    _builder.append("\t");
    _builder.append("<template>");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("<name>gen_sync_test</name>");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("<location id=\"initSync\" x=\"0\" y=\"0\">");
    _builder.newLine();
    _builder.append("\t\t\t");
    _builder.append("<name x=\"-30\" y=\"15\">initSync</name>");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("</location>");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("<transition>");
    _builder.newLine();
    _builder.append("\t\t\t");
    _builder.append("<source ref=\"initSync\"/>");
    _builder.newLine();
    _builder.append("\t\t\t");
    _builder.append("<target ref=\"initSync\"/>");
    _builder.newLine();
    _builder.append("\t\t\t");
    _builder.append("<label kind=\"synchronisation\" x=\"-25\" y=\"-55\">test!</label>");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("</transition>");
    _builder.newLine();
    _builder.append("\t");
    _builder.append("</template>");
    _builder.newLine();
    _builder.append("\t");
    _builder.append("<template>");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("<name>gen_sync_finish</name>");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("<location id=\"initSync\" x=\"0\" y=\"0\">");
    _builder.newLine();
    _builder.append("\t\t\t");
    _builder.append("<name x=\"-30\" y=\"15\">initSync</name>");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("</location>");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("<transition>");
    _builder.newLine();
    _builder.append("\t\t\t");
    _builder.append("<source ref=\"initSync\"/>");
    _builder.newLine();
    _builder.append("\t\t\t");
    _builder.append("<target ref=\"initSync\"/>");
    _builder.newLine();
    _builder.append("\t\t\t");
    _builder.append("<label kind=\"synchronisation\" x=\"-25\" y=\"-55\">finish?</label>");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("</transition>");
    _builder.newLine();
    _builder.append("\t");
    _builder.append("</template>");
    _builder.newLine();
    _builder.append("\t");
    _builder.append("<system>");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("test, gen_sync_test, gen_sync_finish");
    _builder.newLine();
    _builder.append("\t");
    _builder.append("</system>");
    _builder.newLine();
    _builder.append("</nta>");
    _builder.newLine();
    final String xml = _builder.toString();
    Assertions.assertEquals(xml, this.stateMachine.toXml());
  }

  @Test
  public void variables() {
    final Procedure1<StateMachine> _function = (StateMachine it) -> {
      it.variable("hasControl").type("bool").value("false");
    };
    this.stateMachine.name("test").variables(_function).state("one").initial().transition("two").guard("false").when("test").transition("two").guard("true").when("test").action("hasControl := true").state("two").transition("three").timeout(5).signal("finish");
    StringConcatenation _builder = new StringConcatenation();
    _builder.append("<?xml version=\"1.0\" encoding=\"utf-8\"?>");
    _builder.newLine();
    _builder.append("<nta>");
    _builder.newLine();
    _builder.append("\t");
    _builder.append("<declaration>");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("bool hasControl = false;");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("clock gen_clock;");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("chan test, finish;");
    _builder.newLine();
    _builder.append("\t");
    _builder.append("</declaration>");
    _builder.newLine();
    _builder.append("\t");
    _builder.append("<template>");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("<name>test</name>");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("<location id=\"one\" x=\"0\" y=\"0\">");
    _builder.newLine();
    _builder.append("\t\t\t");
    _builder.append("<name x=\"-15\" y=\"15\">one</name>");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("</location>");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("<location id=\"two\" x=\"400\" y=\"0\">");
    _builder.newLine();
    _builder.append("\t\t\t");
    _builder.append("<name x=\"385\" y=\"15\">two</name>");
    _builder.newLine();
    _builder.append("\t\t\t");
    _builder.append("<label kind=\"invariant\" x=\"385\" y=\"30\">gen_clock &lt;= 5</label>");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("</location>");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("<location id=\"three\" x=\"800\" y=\"0\">");
    _builder.newLine();
    _builder.append("\t\t\t");
    _builder.append("<name x=\"785\" y=\"15\">three</name>");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("</location>");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("<init ref=\"one\"/>");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("<transition>");
    _builder.newLine();
    _builder.append("\t\t\t");
    _builder.append("<source ref=\"one\"/>");
    _builder.newLine();
    _builder.append("\t\t\t");
    _builder.append("<target ref=\"two\"/>");
    _builder.newLine();
    _builder.append("\t\t\t");
    _builder.append("<label kind=\"guard\" x=\"150\" y=\"15\">0</label>");
    _builder.newLine();
    _builder.append("\t\t\t");
    _builder.append("<label kind=\"synchronisation\" x=\"150\" y=\"30\">test?</label>");
    _builder.newLine();
    _builder.append("\t\t\t");
    _builder.append("<label kind=\"assignment\" x=\"150\" y=\"45\">gen_clock := 0</label>");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("</transition>");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("<transition>");
    _builder.newLine();
    _builder.append("\t\t\t");
    _builder.append("<source ref=\"one\"/>");
    _builder.newLine();
    _builder.append("\t\t\t");
    _builder.append("<target ref=\"two\"/>");
    _builder.newLine();
    _builder.append("\t\t\t");
    _builder.append("<label kind=\"guard\" x=\"150\" y=\"60\">1</label>");
    _builder.newLine();
    _builder.append("\t\t\t");
    _builder.append("<label kind=\"synchronisation\" x=\"150\" y=\"75\">test?</label>");
    _builder.newLine();
    _builder.append("\t\t\t");
    _builder.append("<label kind=\"assignment\" x=\"150\" y=\"90\">gen_clock := 0, hasControl := true</label>");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("</transition>");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("<transition>");
    _builder.newLine();
    _builder.append("\t\t\t");
    _builder.append("<source ref=\"two\"/>");
    _builder.newLine();
    _builder.append("\t\t\t");
    _builder.append("<target ref=\"three\"/>");
    _builder.newLine();
    _builder.append("\t\t\t");
    _builder.append("<label kind=\"guard\" x=\"550\" y=\"15\">gen_clock &gt;= 5</label>");
    _builder.newLine();
    _builder.append("\t\t\t");
    _builder.append("<label kind=\"synchronisation\" x=\"550\" y=\"30\">finish!</label>");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("</transition>");
    _builder.newLine();
    _builder.append("\t");
    _builder.append("</template>");
    _builder.newLine();
    _builder.append("\t");
    _builder.append("<template>");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("<name>gen_sync_test</name>");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("<location id=\"initSync\" x=\"0\" y=\"0\">");
    _builder.newLine();
    _builder.append("\t\t\t");
    _builder.append("<name x=\"-30\" y=\"15\">initSync</name>");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("</location>");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("<transition>");
    _builder.newLine();
    _builder.append("\t\t\t");
    _builder.append("<source ref=\"initSync\"/>");
    _builder.newLine();
    _builder.append("\t\t\t");
    _builder.append("<target ref=\"initSync\"/>");
    _builder.newLine();
    _builder.append("\t\t\t");
    _builder.append("<label kind=\"synchronisation\" x=\"-25\" y=\"-55\">test!</label>");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("</transition>");
    _builder.newLine();
    _builder.append("\t");
    _builder.append("</template>");
    _builder.newLine();
    _builder.append("\t");
    _builder.append("<template>");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("<name>gen_sync_finish</name>");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("<location id=\"initSync\" x=\"0\" y=\"0\">");
    _builder.newLine();
    _builder.append("\t\t\t");
    _builder.append("<name x=\"-30\" y=\"15\">initSync</name>");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("</location>");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("<transition>");
    _builder.newLine();
    _builder.append("\t\t\t");
    _builder.append("<source ref=\"initSync\"/>");
    _builder.newLine();
    _builder.append("\t\t\t");
    _builder.append("<target ref=\"initSync\"/>");
    _builder.newLine();
    _builder.append("\t\t\t");
    _builder.append("<label kind=\"synchronisation\" x=\"-25\" y=\"-55\">finish?</label>");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("</transition>");
    _builder.newLine();
    _builder.append("\t");
    _builder.append("</template>");
    _builder.newLine();
    _builder.append("\t");
    _builder.append("<system>");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("test, gen_sync_test, gen_sync_finish");
    _builder.newLine();
    _builder.append("\t");
    _builder.append("</system>");
    _builder.newLine();
    _builder.append("</nta>");
    _builder.newLine();
    final String xml = _builder.toString();
    Assertions.assertEquals(xml, this.stateMachine.toXml());
  }

  @Test
  public void nestedMachine() {
    final Procedure1<State> _function = (State it) -> {
      it.nestedState("three");
      it.nestedState("four");
    };
    this.stateMachine.name("test").state("one").initial().state("two").nesting(_function);
    StringConcatenation _builder = new StringConcatenation();
    _builder.append("<?xml version=\"1.0\" encoding=\"utf-8\"?>");
    _builder.newLine();
    _builder.append("<nta>");
    _builder.newLine();
    _builder.append("<declaration>");
    _builder.newLine();
    _builder.append("chan gen_two_inner_start;");
    _builder.newLine();
    _builder.append("</declaration>");
    _builder.newLine();
    _builder.append("<template>");
    _builder.newLine();
    _builder.append("\t");
    _builder.append("<name>test</name>");
    _builder.newLine();
    _builder.append("\t");
    _builder.append("<location id=\"one\" x=\"0\" y=\"0\">");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("<name x=\"-15\" y=\"15\">one</name>");
    _builder.newLine();
    _builder.append("\t");
    _builder.append("</location>");
    _builder.newLine();
    _builder.append("\t");
    _builder.append("<location id=\"gen_pre_two\" x=\"400\" y=\"0\" committed=\"true\">");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("<name x=\"385\" y=\"15\">gen_pre_two</name>");
    _builder.newLine();
    _builder.append("\t");
    _builder.append("</location>");
    _builder.newLine();
    _builder.append("\t");
    _builder.append("<location id=\"two\" x=\"800\" y=\"0\">");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("<name x=\"785\" y=\"15\">two</name>");
    _builder.newLine();
    _builder.append("\t");
    _builder.append("</location>");
    _builder.newLine();
    _builder.append("\t");
    _builder.append("<init ref=\"one\"/>");
    _builder.newLine();
    _builder.append("\t");
    _builder.append("<transition>");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("<source ref=\"gen_pre_two\"/>");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("<target ref=\"two\"/>");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("<label kind=\"synchronisation\">gen_two_inner_start!</label>");
    _builder.newLine();
    _builder.append("\t");
    _builder.append("</transition>");
    _builder.newLine();
    _builder.append("</template>");
    _builder.newLine();
    _builder.append("<template>");
    _builder.newLine();
    _builder.append("\t");
    _builder.append("<name>two_inner</name>");
    _builder.newLine();
    _builder.append("\t");
    _builder.append("<location id=\"gen_init\" x=\"0\" y=\"0\">");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("<name x=\"-15\" y=\"15\">gen_init</name>");
    _builder.newLine();
    _builder.append("\t");
    _builder.append("</location>");
    _builder.newLine();
    _builder.append("\t");
    _builder.append("<location id=\"three\" x=\"400\" y=\"0\">");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("<name x=\"385\" y=\"15\">three</name>");
    _builder.newLine();
    _builder.append("\t");
    _builder.append("</location>");
    _builder.newLine();
    _builder.append("\t");
    _builder.append("<location id=\"four\" x=\"800\" y=\"0\">");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("<name x=\"785\" y=\"15\">four</name>");
    _builder.newLine();
    _builder.append("\t");
    _builder.append("</location>");
    _builder.newLine();
    _builder.append("\t");
    _builder.append("<init ref=\"gen_init\"/>");
    _builder.newLine();
    _builder.append("\t");
    _builder.append("<transition>");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("<source ref=\"gen_init\"/>");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("<target ref=\"three\"/>");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("<label kind=\"synchronisation\" x=\"150\" y=\"15\">gen_two_inner_start?</label>");
    _builder.newLine();
    _builder.append("\t");
    _builder.append("</transition>");
    _builder.newLine();
    _builder.append("</template>");
    _builder.newLine();
    _builder.append("<system>");
    _builder.newLine();
    _builder.append("\t");
    _builder.append("test, two_inner");
    _builder.newLine();
    _builder.append("</system>");
    _builder.newLine();
    _builder.append("</nta>");
    _builder.newLine();
    final String xml = _builder.toString();
    Assertions.assertEquals(xml, this.stateMachine.toXml());
  }

  @Test
  public void nestedMachineWithTransitions() {
    final Procedure1<State> _function = (State it) -> {
      it.nestedState("innerOne").transition("innerTwo").timeout(5).signal("finish");
      it.nestedState("innerTwo");
    };
    this.stateMachine.name("test").state("one").initial().transition("two").when("ready").state("two").nesting(_function).transition("three").when("finish").state("three");
    StringConcatenation _builder = new StringConcatenation();
    _builder.append("clock gen_clock;");
    _builder.newLine();
    _builder.append("chan ready, finish, gen_two_inner_start;");
    _builder.newLine();
    _builder.append("process test {");
    _builder.newLine();
    _builder.append("\t");
    _builder.append("state");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("one,");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("gen_pre_two,");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("two,");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("three;");
    _builder.newLine();
    _builder.append("\t");
    _builder.append("commit gen_pre_two;");
    _builder.newLine();
    _builder.append("\t");
    _builder.append("init one;");
    _builder.newLine();
    _builder.append("\t");
    _builder.append("trans");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("one -> gen_pre_two {");
    _builder.newLine();
    _builder.append("\t\t\t");
    _builder.append("sync ready?;");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("},");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("two -> three {");
    _builder.newLine();
    _builder.append("\t\t\t");
    _builder.append("sync finish?;");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("},");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("gen_pre_two -> two {");
    _builder.newLine();
    _builder.append("\t\t\t");
    _builder.append("sync gen_two_inner_start!;");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("};");
    _builder.newLine();
    _builder.append("}");
    _builder.newLine();
    _builder.append("process two_inner {");
    _builder.newLine();
    _builder.append("\t");
    _builder.append("state");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("gen_init,");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("innerOne {");
    _builder.newLine();
    _builder.append("\t\t\t");
    _builder.append("gen_clock <= 5");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("},");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("innerTwo;");
    _builder.newLine();
    _builder.append("\t");
    _builder.append("commit innerTwo;");
    _builder.newLine();
    _builder.append("\t");
    _builder.append("init gen_init;");
    _builder.newLine();
    _builder.append("\t");
    _builder.append("trans");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("gen_init -> innerOne {");
    _builder.newLine();
    _builder.append("\t\t\t");
    _builder.append("sync gen_two_inner_start?;");
    _builder.newLine();
    _builder.append("\t\t\t");
    _builder.append("assign gen_clock := 0;");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("},");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("innerOne -> innerTwo {");
    _builder.newLine();
    _builder.append("\t\t\t");
    _builder.append("guard gen_clock >= 5;");
    _builder.newLine();
    _builder.append("\t\t\t");
    _builder.append("sync finish!;");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("},");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("innerTwo -> gen_init {");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("};");
    _builder.newLine();
    _builder.append("}");
    _builder.newLine();
    _builder.append("process gen_sync_ready {");
    _builder.newLine();
    _builder.append("\t");
    _builder.append("state");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("initSync;");
    _builder.newLine();
    _builder.append("\t");
    _builder.append("init initSync;");
    _builder.newLine();
    _builder.append("\t");
    _builder.append("trans");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("initSync -> initSync {");
    _builder.newLine();
    _builder.append("\t\t\t");
    _builder.append("sync ready!;");
    _builder.newLine();
    _builder.append("\t\t");
    _builder.append("};");
    _builder.newLine();
    _builder.append("}");
    _builder.newLine();
    _builder.append("system test, two_inner, gen_sync_ready;");
    _builder.newLine();
    final String xml = _builder.toString();
    InputOutput.<String>println(this.stateMachine.toXml());
    Assertions.assertEquals(xml, this.stateMachine.toXml());
  }
}
